#!/usr/bin/env node
/*!
 * COSHA Client
 * by Francesco Bianco <bianco@javanile.org>
 * Copyright(c) 2016-2017 Javanile.org
 * MIT Licensed
 */

const fs = require('fs'),
      path = require('path'),
      open = require('open'),
      nodemon = require('nodemon'),
      localServer = path.join(process.cwd(), 'node_modules/cosha-client/src/server.js'),
      globalServer = path.join(__dirname, '../src/server.js');

nodemon({
    script: !fs.existsSync(localServer) ? globalServer : localServer,
    ext: 'js json'
});

nodemon.on('start', function () {
    console.log('COSHA Client: start');
}).on('quit', function () {
    console.log('COSHA Client: close');
    process.exit();
}).on('restart', function (files) {
    for (let i in files) {
        if (files.hasOwnProperty(i)) {
            console.log('COSHA Client: alter', files[i]);
        }
    }
});

setTimeout(function () {
    open("http://localhost:1983");
}, 500);
